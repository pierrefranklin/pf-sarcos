/* sine and cosine precomputation */
sstate29th=Sin(state[29].th);
cstate29th=Cos(state[29].th);

sstate30th=Sin(state[30].th);
cstate30th=Cos(state[30].th);

sstate31th=Sin(state[31].th);
cstate31th=Cos(state[31].th);

sstate1th=Sin(state[1].th);
cstate1th=Cos(state[1].th);

sstate2th=Sin(state[2].th);
cstate2th=Cos(state[2].th);

sstate3th=Sin(state[3].th);
cstate3th=Cos(state[3].th);

sstate4th=Sin(state[4].th);
cstate4th=Cos(state[4].th);

sstate5th=Sin(state[5].th);
cstate5th=Cos(state[5].th);

sstate6th=Sin(state[6].th);
cstate6th=Cos(state[6].th);

sstate7th=Sin(state[7].th);
cstate7th=Cos(state[7].th);

sstate39th=Sin(state[39].th);
cstate39th=Cos(state[39].th);

sstate40th=Sin(state[40].th);
cstate40th=Cos(state[40].th);

sstate41th=Sin(state[41].th);
cstate41th=Cos(state[41].th);

sstate42th=Sin(state[42].th);
cstate42th=Cos(state[42].th);

sstate43th=Sin(state[43].th);
cstate43th=Cos(state[43].th);

sstate44th=Sin(state[44].th);
cstate44th=Cos(state[44].th);

sstate8th=Sin(state[8].th);
cstate8th=Cos(state[8].th);

sstate9th=Sin(state[9].th);
cstate9th=Cos(state[9].th);

sstate10th=Sin(state[10].th);
cstate10th=Cos(state[10].th);

sstate11th=Sin(state[11].th);
cstate11th=Cos(state[11].th);

sstate12th=Sin(state[12].th);
cstate12th=Cos(state[12].th);

sstate13th=Sin(state[13].th);
cstate13th=Cos(state[13].th);

sstate14th=Sin(state[14].th);
cstate14th=Cos(state[14].th);

sstate45th=Sin(state[45].th);
cstate45th=Cos(state[45].th);

sstate46th=Sin(state[46].th);
cstate46th=Cos(state[46].th);

sstate47th=Sin(state[47].th);
cstate47th=Cos(state[47].th);

sstate48th=Sin(state[48].th);
cstate48th=Cos(state[48].th);

sstate49th=Sin(state[49].th);
cstate49th=Cos(state[49].th);

sstate50th=Sin(state[50].th);
cstate50th=Cos(state[50].th);

sstate32th=Sin(state[32].th);
cstate32th=Cos(state[32].th);

sstate33th=Sin(state[33].th);
cstate33th=Cos(state[33].th);

sstate34th=Sin(state[34].th);
cstate34th=Cos(state[34].th);

sstate35th=Sin(state[35].th);
cstate35th=Cos(state[35].th);

sstate36th=Sin(state[36].th);
cstate36th=Cos(state[36].th);

sstate37th=Sin(state[37].th);
cstate37th=Cos(state[37].th);

sstate38th=Sin(state[38].th);
cstate38th=Cos(state[38].th);

sstate23th=Sin(state[23].th);
cstate23th=Cos(state[23].th);

sstate22th=Sin(state[22].th);
cstate22th=Cos(state[22].th);

sstate24th=Sin(state[24].th);
cstate24th=Cos(state[24].th);

sstate25th=Sin(state[25].th);
cstate25th=Cos(state[25].th);

sstate26th=Sin(state[26].th);
cstate26th=Cos(state[26].th);

sstate27th=Sin(state[27].th);
cstate27th=Cos(state[27].th);

sstate28th=Sin(state[28].th);
cstate28th=Cos(state[28].th);

sstate16th=Sin(state[16].th);
cstate16th=Cos(state[16].th);

sstate15th=Sin(state[15].th);
cstate15th=Cos(state[15].th);

sstate17th=Sin(state[17].th);
cstate17th=Cos(state[17].th);

sstate18th=Sin(state[18].th);
cstate18th=Cos(state[18].th);

sstate19th=Sin(state[19].th);
cstate19th=Cos(state[19].th);

sstate20th=Sin(state[20].th);
cstate20th=Cos(state[20].th);

sstate21th=Sin(state[21].th);
cstate21th=Cos(state[21].th);


/* rotation matrix sine and cosine precomputation */










rseff2a1=Sin(eff[2].a[1]);
rceff2a1=Cos(eff[2].a[1]);

rseff2a2=Sin(eff[2].a[2]);
rceff2a2=Cos(eff[2].a[2]);

rseff2a3=Sin(eff[2].a[3]);
rceff2a3=Cos(eff[2].a[3]);


rsHANDXROT=Sin(HANDXROT);
rcHANDXROT=Cos(HANDXROT);

rsTHUMBZROT=Sin(THUMBZROT);
rcTHUMBZROT=Cos(THUMBZROT);


rsTHUMBANGLEOFF=Sin(THUMBANGLEOFF);
rcTHUMBANGLEOFF=Cos(THUMBANGLEOFF);


rsMinusstate40th=-Sin(state[40].th);
rcMinusstate40th=Cos(state[40].th);



rsHANDXROT=Sin(HANDXROT);
rcHANDXROT=Cos(HANDXROT);


rsstate41th=Sin(state[41].th);
rcstate41th=Cos(state[41].th);


rsstate41th=Sin(state[41].th);
rcstate41th=Cos(state[41].th);



rsHANDXROT=Sin(HANDXROT);
rcHANDXROT=Cos(HANDXROT);


rsstate42th=Sin(state[42].th);
rcstate42th=Cos(state[42].th);


rsstate42th=Sin(state[42].th);
rcstate42th=Cos(state[42].th);



rsHANDXROT=Sin(HANDXROT);
rcHANDXROT=Cos(HANDXROT);


rsstate43th=Sin(state[43].th);
rcstate43th=Cos(state[43].th);


rsstate43th=Sin(state[43].th);
rcstate43th=Cos(state[43].th);



rsHANDXROT=Sin(HANDXROT);
rcHANDXROT=Cos(HANDXROT);


rsstate44th=Sin(state[44].th);
rcstate44th=Cos(state[44].th);


rsstate44th=Sin(state[44].th);
rcstate44th=Cos(state[44].th);










rseff1a1=Sin(eff[1].a[1]);
rceff1a1=Cos(eff[1].a[1]);

rseff1a2=Sin(eff[1].a[2]);
rceff1a2=Cos(eff[1].a[2]);

rseff1a3=Sin(eff[1].a[3]);
rceff1a3=Cos(eff[1].a[3]);


rsMinusHANDXROT=-Sin(HANDXROT);
rcMinusHANDXROT=Cos(HANDXROT);

rsTHUMBZROT=Sin(THUMBZROT);
rcTHUMBZROT=Cos(THUMBZROT);


rsTHUMBANGLEOFF=Sin(THUMBANGLEOFF);
rcTHUMBANGLEOFF=Cos(THUMBANGLEOFF);


rsMinusstate46th=-Sin(state[46].th);
rcMinusstate46th=Cos(state[46].th);



rsMinusHANDXROT=-Sin(HANDXROT);
rcMinusHANDXROT=Cos(HANDXROT);


rsstate47th=Sin(state[47].th);
rcstate47th=Cos(state[47].th);


rsstate47th=Sin(state[47].th);
rcstate47th=Cos(state[47].th);



rsMinusHANDXROT=-Sin(HANDXROT);
rcMinusHANDXROT=Cos(HANDXROT);


rsstate48th=Sin(state[48].th);
rcstate48th=Cos(state[48].th);


rsstate48th=Sin(state[48].th);
rcstate48th=Cos(state[48].th);



rsMinusHANDXROT=-Sin(HANDXROT);
rcMinusHANDXROT=Cos(HANDXROT);


rsstate49th=Sin(state[49].th);
rcstate49th=Cos(state[49].th);


rsstate49th=Sin(state[49].th);
rcstate49th=Cos(state[49].th);



rsMinusHANDXROT=-Sin(HANDXROT);
rcMinusHANDXROT=Cos(HANDXROT);


rsstate50th=Sin(state[50].th);
rcstate50th=Cos(state[50].th);


rsstate50th=Sin(state[50].th);
rcstate50th=Cos(state[50].th);















rsMinusTHIGHANGLEOFF=-Sin(THIGHANGLEOFF);
rcMinusTHIGHANGLEOFF=Cos(THIGHANGLEOFF);


rsTHIGHANGLEOFF=Sin(THIGHANGLEOFF);
rcTHIGHANGLEOFF=Cos(THIGHANGLEOFF);











rseff3a1=Sin(eff[3].a[1]);
rceff3a1=Cos(eff[3].a[1]);

rseff3a2=Sin(eff[3].a[2]);
rceff3a2=Cos(eff[3].a[2]);

rseff3a3=Sin(eff[3].a[3]);
rceff3a3=Cos(eff[3].a[3]);




rsTHIGHANGLEOFF=Sin(THIGHANGLEOFF);
rcTHIGHANGLEOFF=Cos(THIGHANGLEOFF);


rsTHIGHANGLEOFF=Sin(THIGHANGLEOFF);
rcTHIGHANGLEOFF=Cos(THIGHANGLEOFF);











rseff4a1=Sin(eff[4].a[1]);
rceff4a1=Cos(eff[4].a[1]);

rseff4a2=Sin(eff[4].a[2]);
rceff4a2=Cos(eff[4].a[2]);

rseff4a3=Sin(eff[4].a[3]);
rceff4a3=Cos(eff[4].a[3]);



hermes_InvDynNEfunc1();

hermes_InvDynNEfunc2();

hermes_InvDynNEfunc3();

hermes_InvDynNEfunc4();

hermes_InvDynNEfunc5();

hermes_InvDynNEfunc6();

hermes_InvDynNEfunc7();

/* force/torque of base in world coordinates */
fbase[1]=f0[1]*Si00[1][1] + f0[2]*Si00[1][2] + f0[3]*Si00[1][3];
fbase[2]=f0[1]*Si00[2][1] + f0[2]*Si00[2][2] + f0[3]*Si00[2][3];
fbase[3]=f0[1]*Si00[3][1] + f0[2]*Si00[3][2] + f0[3]*Si00[3][3];
fbase[4]=f0[4]*Si00[1][1] + f0[5]*Si00[1][2] + f0[6]*Si00[1][3];
fbase[5]=f0[4]*Si00[2][1] + f0[5]*Si00[2][2] + f0[6]*Si00[2][3];
fbase[6]=f0[4]*Si00[3][1] + f0[5]*Si00[3][2] + f0[6]*Si00[3][3];

/* inverse dynamics torques */
state[29].uff=-state[29].uex + f1[6] + fext1[6];
state[30].uff=-state[30].uex + f2[6] + fext2[6];
state[31].uff=-state[31].uex + f3[6] + fext3[6];
state[1].uff=-state[1].uex + f4[6] + fext4[6];
state[2].uff=-state[2].uex + f5[6] + fext5[6];
state[3].uff=-state[3].uex + f6[6] + fext6[6];
state[4].uff=-state[4].uex + f7[6] + fext7[6];
state[5].uff=-state[5].uex + f8[6] + fext8[6];
state[6].uff=-state[6].uex + f9[6] + fext9[6];
state[7].uff=-state[7].uex + f10[6] + fext10[6];
state[39].uff=-state[39].uex + f12[4] + fext12[4];
state[40].uff=state[40].uex - f13[6] - fext13[6];
state[41].uff=-state[41].uex + f16[6] + fext16[6];
state[42].uff=-state[42].uex + f20[6] + fext20[6];
state[43].uff=-state[43].uex + f24[6] + fext24[6];
state[44].uff=-state[44].uex + f28[6] + fext28[6];
state[8].uff=-state[8].uex + f32[6] + fext32[6];
state[9].uff=-state[9].uex + f33[6] + fext33[6];
state[10].uff=-state[10].uex + f34[6] + fext34[6];
state[11].uff=-state[11].uex + f35[6] + fext35[6];
state[12].uff=-state[12].uex + f36[6] + fext36[6];
state[13].uff=-state[13].uex + f37[6] + fext37[6];
state[14].uff=-state[14].uex + f38[6] + fext38[6];
state[45].uff=-state[45].uex + f40[4] + fext40[4];
state[46].uff=state[46].uex - f41[6] - fext41[6];
state[47].uff=-state[47].uex + f44[6] + fext44[6];
state[48].uff=-state[48].uex + f48[6] + fext48[6];
state[49].uff=-state[49].uex + f52[6] + fext52[6];
state[50].uff=-state[50].uex + f56[6] + fext56[6];
state[32].uff=-state[32].uex + f60[6] + fext60[6];
state[33].uff=-state[33].uex + f61[6] + fext61[6];
state[34].uff=-state[34].uex + f62[6] + fext62[6];
state[35].uff=0. - state[35].uex + f63[6];
state[36].uff=0. - state[36].uex + f64[6];
state[37].uff=0. - state[37].uex + f66[6];
state[38].uff=0. - state[38].uex + f67[6];
state[23].uff=-state[23].uex + f70[6] + fext70[6];
state[22].uff=-state[22].uex + f71[6] + fext71[6];
state[24].uff=-state[24].uex + f72[6] + fext72[6];
state[25].uff=-state[25].uex + f73[6] + fext73[6];
state[26].uff=-state[26].uex + f74[6] + fext74[6];
state[27].uff=-state[27].uex + f75[6] + fext75[6];
state[28].uff=-state[28].uex + f76[6] + fext76[6];
state[16].uff=-state[16].uex + f84[6] + fext84[6];
state[15].uff=-state[15].uex + f85[6] + fext85[6];
state[17].uff=-state[17].uex + f86[6] + fext86[6];
state[18].uff=-state[18].uex + f87[6] + fext87[6];
state[19].uff=-state[19].uex + f88[6] + fext88[6];
state[20].uff=-state[20].uex + f89[6] + fext89[6];
state[21].uff=-state[21].uex + f90[6] + fext90[6];

/* torques due to external forces */
qext[1]=-state[29].uex + fext1[6];
qext[2]=-state[30].uex + fext2[6];
qext[3]=-state[31].uex + fext3[6];
qext[4]=-state[1].uex + fext4[6];
qext[5]=-state[2].uex + fext5[6];
qext[6]=-state[3].uex + fext6[6];
qext[7]=-state[4].uex + fext7[6];
qext[8]=-state[5].uex + fext8[6];
qext[9]=-state[6].uex + fext9[6];
qext[10]=-state[7].uex + fext10[6];
qext[11]=0.;
qext[12]=-state[39].uex + fext12[4];
qext[13]=state[40].uex - fext13[6];
qext[14]=0.;
qext[15]=0.;
qext[16]=-state[41].uex + fext16[6];
qext[17]=0.;
qext[18]=0.;
qext[19]=0.;
qext[20]=-state[42].uex + fext20[6];
qext[21]=0.;
qext[22]=0.;
qext[23]=0.;
qext[24]=-state[43].uex + fext24[6];
qext[25]=0.;
qext[26]=0.;
qext[27]=0.;
qext[28]=-state[44].uex + fext28[6];
qext[29]=0.;
qext[30]=0.;
qext[31]=0.;
qext[32]=-state[8].uex + fext32[6];
qext[33]=-state[9].uex + fext33[6];
qext[34]=-state[10].uex + fext34[6];
qext[35]=-state[11].uex + fext35[6];
qext[36]=-state[12].uex + fext36[6];
qext[37]=-state[13].uex + fext37[6];
qext[38]=-state[14].uex + fext38[6];
qext[39]=0.;
qext[40]=-state[45].uex + fext40[4];
qext[41]=state[46].uex - fext41[6];
qext[42]=0.;
qext[43]=0.;
qext[44]=-state[47].uex + fext44[6];
qext[45]=0.;
qext[46]=0.;
qext[47]=0.;
qext[48]=-state[48].uex + fext48[6];
qext[49]=0.;
qext[50]=0.;
qext[51]=0.;
qext[52]=-state[49].uex + fext52[6];
qext[53]=0.;
qext[54]=0.;
qext[55]=0.;
qext[56]=-state[50].uex + fext56[6];
qext[57]=0.;
qext[58]=0.;
qext[59]=0.;
qext[60]=-state[32].uex + fext60[6];
qext[61]=-state[33].uex + fext61[6];
qext[62]=-state[34].uex + fext62[6];
qext[63]=0. - state[35].uex;
qext[64]=0. - state[36].uex;
qext[65]=0.;
qext[66]=0. - state[37].uex;
qext[67]=0. - state[38].uex;
qext[68]=0.;
qext[69]=0.;
qext[70]=-state[23].uex + fext70[6];
qext[71]=-state[22].uex + fext71[6];
qext[72]=-state[24].uex + fext72[6];
qext[73]=-state[25].uex + fext73[6];
qext[74]=-state[26].uex + fext74[6];
qext[75]=-state[27].uex + fext75[6];
qext[76]=-state[28].uex + fext76[6];
qext[77]=0.;
qext[78]=0.;
qext[79]=0.;
qext[80]=0.;
qext[81]=0.;
qext[82]=0.;
qext[83]=0.;
qext[84]=-state[16].uex + fext84[6];
qext[85]=-state[15].uex + fext85[6];
qext[86]=-state[17].uex + fext86[6];
qext[87]=-state[18].uex + fext87[6];
qext[88]=-state[19].uex + fext88[6];
qext[89]=-state[20].uex + fext89[6];
qext[90]=-state[21].uex + fext90[6];
qext[91]=0.;
qext[92]=0.;
qext[93]=0.;
qext[94]=0.;
qext[95]=0.;
qext[96]=0.;
qext[97]=0.;

